This project was bootstrapped with [Create React App](https://github.com/facebook/create-react-app).

## Available Scripts
"start": "react-scripts start",

"envoy": "./getenvoy run standard:1.13.1 -- --config-path ./envoy.yaml",

"build": "react-scripts build",

"test": "react-scripts test",

"eject": "react-scripts eject"

# How to Run
 
1. Clone the repository
2. Navigate to the "sustain-dataset-explorer" directory
3. Run `npm install`
4. Perform any clean-up or audit operations requested by NPM (not necessary, but good practice)
5. Run locally using `npm run start`

# Deploying on a secure server
This project can be built and deployed on a server using `npm run build`. But It can more complicated than that depending on your web-server configuration and Content Security Policy settings

Below are the steps to run the dataset-explorer on a secure server with some really strict CSP rules.

1.  change the src/sustain/grpc_client/census_pb.js to remove the unsafe-eval problem(check line 14, the var global line) 
    
    *Description*: If your web server sets the CSP rules to not allow unsafe evaluation of javascript, a browser does not trust any javascript written in js files.
    This can cause a problem to occur when you are using grpc-js, 
    
    This is because one of the grpc protobuffer files generated by default(the `protoc` command I believe) when starting a grpc-js project
    generates a file with the line 
    
    `var global = Function('return this')` 
    
    (I remember this line by-heart now, I've seen it break the app so many times)

    Your servers CSP rules may/may not contain the `unsafe-eval` rule. This will crash(not load) your site.
    Luckily there is a rough solution posted on a github issue thread [here](https://github.com/protocolbuffers/protobuf/issues/5464)
          
2. 	`npm run build`
3.  `chmod` the build directory with the right permissions
4.  inside the build directory, open index.html and remove all the javascript to another file called indexjavascript.js

    *Description*: This depends again on the CSP rules set on your web server. 
    Another CSP rule that may/may not be set is the `unsafe-inline`. 
    
    If not set, I think that any inline javascript on any `.html` web pages is treated as unsafe and is not executed. it is a web-server level setting as far as I know.  
5.  place indexjavascript.js into build/static/js/ and add a script tag with that reference in the index.html
6. 	clear browser cache and load 